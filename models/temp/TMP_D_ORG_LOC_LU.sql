
{{config(
    tags=["loc"]
    ,pre_hook=mpre_hook(c_package="LOC", c_status="RUNNING", c_bookmark="AFTER_STG")
    )}}

SELECT
    LOC_ID,
    LOC_DESC,
    DST.DST_KEY as DST_KEY,
    DST.DST_ID as DST_ID,
    DST.DST_DESC as DST_DESC,
    DST.RGN_KEY as RGN_KEY,
    DST.RGN_ID as RGN_ID,
    DST.RGN_DESC as RGN_DESC,
    DST.ARA_KEY as ARA_KEY,
    DST.ARA_ID as ARA_ID,
    DST.ARA_DESC as ARA_DESC,
    DST.CHN_KEY as CHN_KEY,
    DST.CHN_ID as CHN_ID,
    DST.CHN_DESC as CHN_DESC,
    CHNL.CHNL_KEY as CHNL_KEY,
    CHNL.CHNL_ID as CHNL_ID,
    CHNL.CHNL_DESC as CHNL_DESC,
    --DST.COMPANY_KEY as COMPANY_KEY,
    --DST.COMPANY_ID as COMPANY_ID,
    --DST.COMPANY_DESC as COMPANY_DESC,
    -1 as COMPANY_KEY,
    -1 as COMPANY_ID,
    -1 as COMPANY_DESC,
    CNCY_CDE,
    LOC_TYP_CDE,
    LOC_TYP_CDE_DESC,
    STR_TYP_CDE,
    STR_TYP_CDE_DESC,
    LOC_STATE_CDE,
    LOC_STATE_CDE_DESC,
    LOC_COUNTRY_CDE,
    LOC_COUNTRY_CDE_DESC,
    LOC_FMT_CDE,
    LOC_FMT_CDE_DESC,
    TSF_ZONE_CDE,
    TSF_ZONE_CDE_DESC,
    LOC_UPS_DST,
    LOC_VAT_RGN,
    LOC_STKHLD_IND,
    LOC_VAT_INCLUDE_IND,
    LOC_BREAK_PACK_IND,
    LOC_PHY_WH_NUM,
    LOC_VIRTUAL_WH_NUM,
    LOC_DEFAULT_WH_NUM,
    LOC_LAST_REMODEL_DT,
    LOC_START_DT,
    LOC_END_DT,
    LOC.RMS_LOAD_DATE,
    RMS_Q_DC_ID,
    RMS_Q_STR_DC_FLG,
    RMS_Q_STR_SLS_SQFT,
    RMS_ORG_HIER_TYPE,
    RMS_Q_STR_SELLING_FLG,
    RMS_Q_STR_DNUM,
    RMS_Q_STR_ADDR2,
    RMS_Q_STR_SDESC,
    RMS_Q_STR_STATUS,
    RMS_Q_STR_CITY,
    RMS_Q_STR_LATI,
    RMS_Q_STR_GRD,
    RMS_Q_STR_ZIP,
    RMS_CLIMATE,
    LOC.RMS_SRC_ID as RMS_SRC_ID,
    RMS_Q_STR_ADDR1,
    RMS_PROTECTED_IND,
    RMS_Q_STR_CMP_DT,
    RMS_VOLUME,
    RMS_TOTAL_SQUARE_FT,
    RMS_WH_ADD1,
    RMS_TIER

    FROM {{ref('V_STG_D_ORG_LOC_LU')}} AS LOC 
    LEFT OUTER JOIN {{ref('DWH_D_ORG_DST_LU')}} AS DST 
    ON LOC.DST_ID = DST.DST_ID
    LEFT OUTER JOIN {{ref('DWH_D_ORG_CHNL_LU')}} AS CHNL 
    ON LOC.CHNL_ID = CHNL.CHNL_ID
