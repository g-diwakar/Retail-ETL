{{config(
    tags=["sty"]
    ,pre_hook=mpre_hook(c_package="STY", c_status="RUNNING", c_bookmark="AFTER_STG")
    )}}

SELECT
    STY_ID,
    STY_DESC,
    SBC_KEY,
    SBC_DESC,
    STY.SBC_ID as SBC_ID,
    CLS_KEY,
    STY.CLS_ID as CLS_ID,
    CLS_DESC,
    DPT_KEY,
    STY.DPT_ID as DPT_ID,
    DPT_DESC,
    GRP_KEY,
    STY.GRP_ID as GRP_ID,
    GRP_DESC,
    DIV_KEY,
    STY.DIV_ID,
    DIV_DESC,
    COMPANY_KEY,
    STY.COMPANY_ID,
    COMPANY_DESC,
    SUP_ID,
    SUP_KEY,
    SUP_DESC,
    STND_UOM_CDE,
    MER_IND,
    FCST_IND,
    INV_IND,
    PACK_IND,
    SIMPLE_PACK_IND,
    ORDERABLE_IND,
    SELLABLE_IND,
    FIRST_RCVD_DT,
    LAST_RCVD_DT,
    RMS_Q_CURR_PRICE_STATUS,
    RMS_PACK_SIMPLE_CDE,
    STY.RMS_SRC_ID as RMS_SRC_ID,
    RMS_DEPT_IDNT,
    RMS_ITEM_SECND_DESC,
    RMS_CLASS_IDNT,
    RMS_Q_STATUS_FLAG,
    RMS_Q_LAST_RECPT_DT,
    RMS_Q_CURR_UNIT_RTL,
    RMS_Q_STY_SDESC,
    RMS_Q_STY_IMG_L,
    RMS_STND_UOM_CDE,
    RMS_SBCLASS_IDNT,
    RMS_TRAN_LEVEL,
    RMS_ITEM_NBR_TYPE_CDE,
    RMS_PACK_ORDERABLE_CDE,
    RMS_Q_SEASON_CDE,
    RMS_Q_AST_SNUM,
    RMS_Q_STY_IMG_S,
    RMS_LEVEL3_IDNT,
    RMS_ITEM_LEVEL,
    RMS_PACK_IND,
    RMS_Q_FIRST_RECPT_DT,
    RMS_Q_SBC_SNUM,
    RMS_Q_STY_IMG,
    RMS_Q_ORIG_UNIT_RTL

FROM {{ref('V_STG_D_PRD_STY_LU')}} AS STY 
LEFT OUtER JOIN {{ref('DWH_D_PRD_SBC_LU')}} AS SBC
ON STY.SBC_ID = SBC.SBC_ID AND
STY.CLS_ID = SBC.CLS_ID AND
STY.DPT_ID = SBC.DPT_ID
